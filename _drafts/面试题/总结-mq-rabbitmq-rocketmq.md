面试-rabbitmq
===

### **消息队列**

*   消息队列的使用场景

*   消息的重发补偿解决思路

*   消息的幂等性解决思路

*   消息的堆积解决思路

*   自己如何实现消息队列

*   如何保证消息的有序性

# RabbitMQ的消息可靠性是如何保证的？
https://www.jianshu.com/p/ea04ee9504c3
可靠性是一个相对的概念，在条件合理的范围内系统所能确保的多少个9的可靠性。一切尽可能的趋于完美而无法企及于完美。
从AMQP协议层面上来说：

1.  消息先从生产者Producer出发到达交换器Exchange；
2.  交换器Exchange根据路由规则将消息转发对应的队列Queue之上；
3.  消息在队列Queue上进行存储；
4.  消费者Consumer订阅队列Queue并进行消费。
    我们对于消息可靠性的分析也从这四个阶段来一一探讨。
-事务机制或发送方确认机制，事务机制不建议使用，是阻塞的，发送方确认机制是异步的，事务机制和publisher confirm机制确保的是消息能够正确的发送至RabbitMQ
- 从交换器到队列的可靠性保证，消息退回机制或消息进入备份交换器
- 消息的持久化，由于不是每条消息都同步的持久化，所以可能存在未落盘，丢消息
，如果开启了发送方确认，消息的确认是在，消息落盘后确认的，同时还可以通过镜像机制，保证消息的高可用性
- 消费方确认，消费方正确消费消息后，通过ack确认，对于不能ack 的消息可以进入私信队列，后续再进行处理

# RabbitMQ集群了解吗？
除了消息之外的信息为元信息，节点分为磁盘节点和内存节点，集群中至少存在一个磁盘节点，磁盘节点保证集群重启的时候可以重建持久化的Exchange，Queue等信息
集群模式有如下两种：。

- 普通模式（追求吞吐量）：默认的集群模式，队列只创建于一个节点中，当消息进入A节点的Queue中后，consumer从B节点拉取时，RabbitMQ会临时在A、B间进行消息传输，把A中的消息实体取出并经过B发送给consumer，所以consumer应平均连接每一个节点，从中取消息。队列只在一个节点创建的策略是出于性能的考虑，这样数据没有冗余，可以提高节点吞吐量，方便横向扩展，Exchange会在集群的全部节点上创建。
- **镜像模式（追求高可用）**：把需要的队列做成镜像队列，存在于多个节点，[属于RabbitMQ的HA方案](http://www.rabbitmq.com/ha.html)（镜像模式是在普通模式的基础上，增加一些镜像策略）该模式解决了上述问题，其实质和普通模式不同之处在于，消息实体会主动在镜像节点间同步，而不是在consumer取数据时临时拉取。该模式带来的副作用也很明显，除了降低系统性能外，如果镜像队列数量过多，加之大量的消息进入，集群内部的网络带宽将会被这种同步通讯大大消耗掉。所以在对可靠性要求较高的场合中适用，一个队列想做成镜像队列，需要先设置policy，然后客户端创建队列的时候，rabbitmq集群根据“队列名称”自动设置是普通集群模式或镜像队列。
consumer，任意连接一个节点，若连上的不是master，请求会转发给master，为了保证消息的可靠性，consumer回复ack给master后，master删除消息并广播所有的slaver去删除。 
publisher ，任意连接一个节点，若连上的不是master，则转发给master，由master存储并转发给其他的slaver存储。 
如果master挂掉，则从slaver中选择消息队列最长的为master，在这种情况下可以存在消息未同步给ack消息未同步的情况，会造成消息重发（默认是异步同步的）

# RabbitMQ遇到过什么问题吗？
刚开始使用，由于经验不足，对于消息的消费，在消费成功后确认的，对于没消费成功的，没有确认，导致消息重新入队列，入在了开始位置，当未确认的消息太多时，所有连接都被占用，重复消费这些消费不了的消息，导致消息开始堆积，后来通过引入私信队列，解决了次问题。

rabbitmq：
rabbitmq 的事务了解吗？
rabbitmq 消息的ack？
9，rabbitmq 消息是基于拉的，还是推的？拉和推的区别


项目中哪里用到了ActiveMQ？ActiveMQ是拉还是推？两者区别
5.  mq是如何使用的？
1.kafka的原理是什么？可以用来做什么
9.说说rocketMQ的优点，为什么采用他？它与其他的消息队列有什么不同？


消息中间件如何解决消息丢失问题

### 消息队列

*   消息队列的使用场景

*   消息的重发补偿解决思路

*   消息的幂等性解决思路

*   消息的堆积解决思路

*   自己如何实现消息队列

*   如何保证消息的有序性

消息中间件如何解决消息丢失问题

